<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RTMs &mdash; SCOPE 1.8 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d13700ae"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fluxes" href="fluxes.html" />
    <link rel="prev" title="IO (input output)" href="IO.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SCOPE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model_capabilities.html">Model capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../options.html">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../directories.html">Directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outfiles.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">Brief history of the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zreferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mSCOPE.html">mSCOPE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../retrieval.html">Retrieval (Model inversion)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../youtube.html">YouTube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../structs.html">Structs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="IO.html">IO (input output)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">RTMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="fluxes.html">fluxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="lut.html">+lut</a></li>
<li class="toctree-l2"><a class="reference internal" href="supporting.html">supporting</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SCOPE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API</a></li>
      <li class="breadcrumb-item active">RTMs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/RTMs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rtms">
<h1>RTMs<a class="headerlink" href="#rtms" title="Link to this heading"></a></h1>
<p id="module-src.RTMs">Radiative transfer models for soil, leaf and canopy.</p>
<p>Soil</p>
<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.BSM">
<span class="sig-name descname"><span class="pre">BSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">soilpar</span></em>, <em class="sig-param"><span class="pre">spec</span></em>, <em class="sig-param"><span class="pre">emp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.BSM" title="Link to this definition"></a></dt>
<dd><p>Spectral parameters</p>
</dd></dl>

<p>Leaf</p>
<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.fluspect_B_CX">
<span class="sig-name descname"><span class="pre">fluspect_B_CX</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.fluspect_B_CX" title="Link to this definition"></a></dt>
<dd><p>function [leafopt] = fluspect(spectral,leafbio,optipar)
calculates reflectance and transmittance spectra of a leaf using FLUSPECT, 
plus four excitation-fluorescence matrices</p>
<p>Authors: Wout Verhoef, Christiaan van der Tol (<a class="reference external" href="mailto:c&#46;vandertol&#37;&#52;&#48;utwente&#46;nl" rel="noopener noreferrer" target="_blank">c<span>&#46;</span>vandertol<span>&#64;</span>utwente<span>&#46;</span>nl</a>),
Joris Timmermans, Nastassia Vilfan
Date: 2007-2020
Update from PROSPECT to FLUSPECT: January 2011 (CvdT)</p>
<blockquote>
<div><blockquote>
<div><p>Nov 2012 (CvdT) Output EF-matrices separately for PSI and PSII</p>
</div></blockquote>
<p>31 Jan 2013 (WV)   Adapt to SCOPE v_1.40, using structures for I/O
30 May 2013 (WV)   Repair bug in s for non-conservative scattering
24 Nov 2013 (WV)   Simplified doubling routine
25 Nov 2013 (WV)   Restored piece of code that takes final refl and</p>
<blockquote>
<div><p>tran outputs as a basis for the doubling routine</p>
</div></blockquote>
<dl class="simple">
<dt>03 Dec 2013 (WV)   Major upgrade. Border interfaces are removed before </dt><dd><p>the fluorescence calculation and later added again</p>
</dd>
<dt>23 Dec 2013 (WV)   Correct a problem with N = 1 when calculating k </dt><dd><p>and s; a test on a = Inf was included</p>
</dd>
</dl>
<p>01 Apr 2014 (WV)   Add carotenoid concentration (Cca and Kca)
19 Jan 2015 (WV)   First beta version for simulation of PRI effect
20 Jan 2021 (CvdT) Include PROSPECT-PRO coefficients</p>
</div></blockquote>
<p>usage:
[leafopt] = fluspect_b(spectral,leafbio,optipar)</p>
<p>inputs:
Cab         = leafbio.Cab;
Cca         = leafbio.Cca;
V2Z         = leafbio.V2Z;  % Violaxanthin - Zeaxanthin transition status</p>
<blockquote>
<div><p>[0-1]</p>
</div></blockquote>
<p>Cw          = leafbio.Cw;
Cdm         = leafbio.Cdm;
Cs          = leafbio.Cs;
N           = leafbio.N; 
fqe         = leafbio.fqe;</p>
<p>nr          = optipar.nr;
Kdm         = optipar.Kdm;
Kab         = optipar.Kab;
Kca         = optipar.Kca;
KcaV        = optipar.KcaV;
KcaZ        = optipar.KcaZ;
Kw          = optipar.Kw;
Ks          = optipar.Ks;
Kp          = optipar.Kp;
Kcbc        = optipar.Kcbc;
phi         = optipar.phi;
outputs:
refl          reflectance
tran          transmittance
Mb            backward scattering fluorescence matrix, I for PSI and II for PSII
Mf            forward scattering fluorescence matrix,  I for PSI and II for PSII</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.fluspect_B_CX_PSI_PSII_combined">
<span class="sig-name descname"><span class="pre">fluspect_B_CX_PSI_PSII_combined</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.fluspect_B_CX_PSI_PSII_combined" title="Link to this definition"></a></dt>
<dd></dd></dl>

<p>Canopy</p>
<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.RTMf">
<span class="sig-name descname"><span class="pre">RTMf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">constants</span></em>, <em class="sig-param"><span class="pre">spectral</span></em>, <em class="sig-param"><span class="pre">rad</span></em>, <em class="sig-param"><span class="pre">soil</span></em>, <em class="sig-param"><span class="pre">leafopt</span></em>, <em class="sig-param"><span class="pre">canopy</span></em>, <em class="sig-param"><span class="pre">gap</span></em>, <em class="sig-param"><span class="pre">angles</span></em>, <em class="sig-param"><span class="pre">etau</span></em>, <em class="sig-param"><span class="pre">etah</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.RTMf" title="Link to this definition"></a></dt>
<dd><p>function ‘RTMf’ calculates the spectrum of fluorescent radiance in the
observer’s direction and also the TOC spectral hemispherical upward Fs flux</p>
<p>Authors:  Wout Verhoef and Christiaan van der Tol (<a class="reference external" href="mailto:c&#46;vandertol&#37;&#52;&#48;utwente&#46;nl&#46;nl" rel="noopener noreferrer" target="_blank">c<span>&#46;</span>vandertol<span>&#64;</span>utwente<span>&#46;</span>nl<span>&#46;</span>nl</a>)
Date:     12 Dec 2007
Update:   26 Aug 2008 CvdT        small correction to matrices</p>
<blockquote>
<div><p>07 Nov 2008 CvdT        changed layout</p>
</div></blockquote>
<dl class="simple">
<dt>Update:   19 Mar 2009 CvdT        major corrections: lines 95-96,</dt><dd><p>101-107, and 119-120.</p>
</dd>
<dt>Update:    7 Apr 2009 WV &amp; CvdT   major correction: lines 89-90, azimuth</dt><dd><p>dependence was not there in previous verions (implicit assumption of
azimuth(solar-viewing) = 0). This has been corrected</p>
</dd>
<dt>Update:   May-June 2012 WV &amp; CvdT Add calculation of hemispherical Fs</dt><dd><p>fluxes</p>
</dd>
<dt>Update:   Jan-Feb 2013 WV         Inputs and outputs via structures for</dt><dd><p>SCOPE Version 1.40</p>
</dd>
<dt>Update:   Aug-Oct 2016 PY         Re-write the calculation of emitted SIF</dt><dd><p>of each layer. It doesnt use loop at
all. with the function bsxfun, the
calculation is much faster</p>
</dd>
</dl>
<p>Update:   Oct 2017-Feb 2018 PY    Re-write the RTM of fluorescence
Update:   Jan 2020 CvdT           Modified to include ‘lite’ option,</p>
<blockquote>
<div><p>mSCOPE representation</p>
</div></blockquote>
<p>Update:   25 Jun 2020 PY          Po, Ps, Pso. fix the problem we have with the oblique angles above 80 degrees</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.RTMo">
<span class="sig-name descname"><span class="pre">RTMo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">spectral</span></em>, <em class="sig-param"><span class="pre">atmo</span></em>, <em class="sig-param"><span class="pre">soil</span></em>, <em class="sig-param"><span class="pre">leafopt</span></em>, <em class="sig-param"><span class="pre">canopy</span></em>, <em class="sig-param"><span class="pre">angles</span></em>, <em class="sig-param"><span class="pre">constants</span></em>, <em class="sig-param"><span class="pre">meteo</span></em>, <em class="sig-param"><span class="pre">options</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.RTMo" title="Link to this definition"></a></dt>
<dd><dl>
<dt>calculates the spectra of hemisperical and directional observed visible </dt><dd><p>and thermal radiation (fluxes E and radiances L), as well as the single 
and bi-directional gap probabilities</p>
<p>the function does not require any non-standard Matlab functions. No
changes to the code have to be made to operate the function for a
particular canopy. All necessary parameters and variables are input or
global and need to be specified elsewhere.</p>
<dl>
<dt>Authors:      Wout Verhoef            (<a class="reference external" href="mailto:w&#46;verhoef&#37;&#52;&#48;utwente&#46;nl" rel="noopener noreferrer" target="_blank">w<span>&#46;</span>verhoef<span>&#64;</span>utwente<span>&#46;</span>nl</a>) </dt><dd><p>Christiaan van der Tol  (<a class="reference external" href="mailto:c&#46;vandertol&#37;&#52;&#48;utwente&#46;nl" rel="noopener noreferrer" target="_blank">c<span>&#46;</span>vandertol<span>&#64;</span>utwente<span>&#46;</span>nl</a>)
Joris Timmermans        ()</p>
</dd>
<dt>updates:      10 Sep 2007 (CvdT)      - calculation of Rn</dt><dd><blockquote>
<div><p>5 Nov 2007             - included observation direction</p>
</div></blockquote>
<dl class="simple">
<dt>12 Nov 2007             - included abs. PAR spectrum output</dt><dd><ul class="simple">
<li><p>improved calculation efficiency</p></li>
</ul>
</dd>
</dl>
<p>13 Nov 2007             - written readme lines
11 Feb 2008 (WV&amp;JT)     - changed Volscat</p>
<blockquote>
<div><dl>
<dt>(JT)        - small change in calculation Po,Ps,Pso</dt><dd><blockquote>
<div><ul class="simple">
<li><p>introduced parameter ‘lazitab’</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>changed nomenclature</p></li>
<li><p>Appendix IV: cosine rule</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>04 Aug 2008 (JT)        - Corrections for Hotspot effect in the probabilities
05 Nov 2008 (CvdT)      - Changed layout
04 Jan 2011 (JT &amp; CvdT) - Included Pso function (Appendix IV)</p>
<blockquote>
<div><ul class="simple">
<li><p>removed the analytical function (for checking)</p></li>
</ul>
</div></blockquote>
<p>02 Oct 2012 (CvdT)      - included incident PAR in output</p>
<dl>
<dt>Jan/Feb 2013 (WV)       - Major revision towards SCOPE version 1.40:</dt><dd><ul class="simple">
<li><p>Parameters passed using structures</p></li>
<li><p>Improved interface with MODTRAN atmospheric data</p></li>
<li><p>Now also calculates 4-stream
reflectances rso, rdo, rsd and rdd
analytically</p></li>
</ul>
</dd>
<dt>Apri 2013 (CvT)         - improvements in variable names</dt><dd><blockquote>
<div><p>and descriptions</p>
</div></blockquote>
<p>Dec 2019 CvdT        mSCOPE representation, lite option</p>
</dd>
</dl>
</dd>
</dl>
<p>Table of contents of the function</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li><p>Preparations</p></li>
</ol>
<blockquote>
<div><p>0.1     parameters
0.2     initialisations</p>
</div></blockquote>
<ol class="arabic simple">
<li><p>Geometric quantities</p></li>
</ol>
<blockquote>
<div><p>1.1     general geometric quantities
1.2     geometric factors associated with extinction and scattering
1.3     geometric factors to be used later with rho and tau
1.4     solar irradiance factor for all leaf orientations
1.5     probabilities Ps, Po, Pso</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Calculation of upward and downward fluxes</p></li>
<li><p>Outgoing fluxes, hemispherical and in viewing direction, spectrum</p></li>
</ol>
<p>4.      Net fluxes, spectral and total, and incoming fluxes
A1      functions J1 and J2 (introduced for stable solutions)
A2      function volscat
A3      function e2phot
A4      function Pso</p>
</div></blockquote>
<p>references:</p>
</dd>
<dt>{1} Verhoef (1998), ‘Theory of radiative transfer models applied in</dt><dd><p>optical remote sensing of vegetation canopies’. PhD Thesis Univ. Wageninegn</p>
</dd>
<dt>{2} Verhoef, W., Jia, L., Xiao, Q. and Su, Z. (2007) Unified optical -</dt><dd><p>thermal four - stream radiative transfer theory for homogeneous 
vegetation canopies. IEEE Transactions on geoscience and remote 
sensing, 45,6.</p>
</dd>
<dt>{3} Verhoef (1985), ‘Earth Observation Modeling based on Layer Scattering</dt><dd><blockquote>
<div><p>Matrices’, Remote sensing of Environment, 17:167-175</p>
</div></blockquote>
<p>Usage:
function [rad,gap,profiles] = RTMo(spectral,atmo,soil,leafopt,canopy,angles,meteo,rad,options)</p>
<p>The input and output are structures. These structures are further
specified in a readme file.</p>
<dl>
<dt>Input:</dt><dd><p>spectral    information about wavelengths and resolutions
atmo        MODTRAN atmospheric parameters
soil        soil properties
leafopt     leaf optical properties
canopy      canopy properties (such as LAI and height)
angles      viewing and observation angles
meteo       has the meteorological variables. Is only used to correct</p>
<blockquote>
<div><p>the total irradiance if a specific value is provided
instead of the usual Modtran output.</p>
</div></blockquote>
<p>rad         initialization of the structure of the output ‘rad’
options     simulation options. Here, the option</p>
<blockquote>
<div><p>‘calc_vert_profiles’ is used, a boolean that tells whether 
or not to output data of 60 layers separately.</p>
</div></blockquote>
</dd>
<dt>Output:</dt><dd><p>gap         probabilities of direct light penetration and viewing
rad         a large number of radiative fluxes: spectrally distributed</p>
<blockquote>
<div><p>and integrated, and canopy radiative transfer coefficients.</p>
</div></blockquote>
<dl class="simple">
<dt>profiles    vertical profiles of radiation variables such as absorbed</dt><dd><p>PAR.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.RTMt_planck">
<span class="sig-name descname"><span class="pre">RTMt_planck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">spectral</span></em>, <em class="sig-param"><span class="pre">rad</span></em>, <em class="sig-param"><span class="pre">soil</span></em>, <em class="sig-param"><span class="pre">leafopt</span></em>, <em class="sig-param"><span class="pre">canopy</span></em>, <em class="sig-param"><span class="pre">gap</span></em>, <em class="sig-param"><span class="pre">Tcu</span></em>, <em class="sig-param"><span class="pre">Tch</span></em>, <em class="sig-param"><span class="pre">Tsu</span></em>, <em class="sig-param"><span class="pre">Tsh</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.RTMt_planck" title="Link to this definition"></a></dt>
<dd><p>function ‘RTMt_sb’ calculates total outgoing radiation in hemispherical
direction and total absorbed radiation per leaf and soil component.
Radiation is integrated over the whole thermal spectrum with
Stefan-Boltzman’s equation. This function is a simplified version of
‘RTMt_planck’, and is less time consuming since it does not do the
calculation for each wavelength separately.</p>
<p>Authors: Wout Verhoef and Christiaan van der Tol (<a class="reference external" href="mailto:c&#46;vandertol&#37;&#52;&#48;utwente&#46;nl" rel="noopener noreferrer" target="_blank">c<span>&#46;</span>vandertol<span>&#64;</span>utwente<span>&#46;</span>nl</a>)
date:     5  Nov 2007
update:   13 Nov 2007</p>
<blockquote>
<div><p>16 Nov 2007 CvdT    improved calculation of net radiation
27 Mar 2008 JT      added directional calculation of radiation
24 Apr 2008 JT      Introduced dx as thickness of layer (see parameters)
31 Oct 2008 JT      introduced optional directional calculation
31 Oct 2008 JT      changed initialisation of F1 and F2 -&gt; zeros
07 Nov 2008 CvdT    changed layout
16 Mar 2009 CvdT    removed Tbright calculation</p>
<blockquote>
<div><p>Feb 2013 WV      introduces structures for version 1.40</p>
</div></blockquote>
<p>04 Dec 2019 CvdT    adapted for SCOPE-lite
17 Mar 2020 CvdT    mSCOPE representation</p>
</div></blockquote>
<dl>
<dt>Table of contents of the function</dt><dd><dl class="simple">
<dt>0       preparations</dt><dd><p>0.0     globals
0.1     initialisations
0.2     parameters
0.3     geometric factors of Observer
0.4     geometric factors associated with extinction and scattering
0.5     geometric factors to be used later with rho and tau
0.6     fo for all leaf angle/azumith classes</p>
</dd>
</dl>
<p>1       calculation of upward and downward fluxes
2       total net fluxes
Appendix A. Stefan-Boltzmann</p>
</dd>
</dl>
<p>usage:
[rad] = RTMt_sb(constants,rad,soil,leafbio,canopy,gap,Tcu,Tch,Tsu,Tsh,obsdir,spectral)</p>
<p>Most input and output are structures. These structures are further
specified in a readme file. The temperatures Tcu, Tch, Tsu and Tsh are
variables.</p>
<dl>
<dt>Input:</dt><dd><p>constants   physical constants
rad         a large number of radiative fluxes: spectrally distributed</p>
<blockquote>
<div><p>and integrated, and canopy radiative transfer coefficients</p>
</div></blockquote>
<p>soil        soil properties
leafopt     leaf optical properties
canopy      canopy properties (such as LAI and height)
gap         probabilities of direct light penetration and viewing
Tcu         Temperature of sunlit leaves    (oC), [13x36x60]
Tch         Temperature of shaded leaves    (oC), [13x36x60]
Tsu         Temperature of sunlit soil      (oC), [1]
Tsh         Temperature of shaded soil      (oC), [1]</p>
</dd>
<dt>Output:</dt><dd><dl class="simple">
<dt>rad         a large number of radiative fluxes: spectrally distributed</dt><dd><p>and integrated, and canopy radiative transfer coefficients.
Here, thermal fluxes are added</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.RTMz">
<span class="sig-name descname"><span class="pre">RTMz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">constants</span></em>, <em class="sig-param"><span class="pre">spectral</span></em>, <em class="sig-param"><span class="pre">rad</span></em>, <em class="sig-param"><span class="pre">soil</span></em>, <em class="sig-param"><span class="pre">leafopt</span></em>, <em class="sig-param"><span class="pre">canopy</span></em>, <em class="sig-param"><span class="pre">gap</span></em>, <em class="sig-param"><span class="pre">angles</span></em>, <em class="sig-param"><span class="pre">Knu</span></em>, <em class="sig-param"><span class="pre">Knh</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.RTMz" title="Link to this definition"></a></dt>
<dd><p>function ‘RTMz’ calculates the small modification of TOC outgoing
radiance due to the conversion of Violaxanthin into Zeaxanthin in leaves</p>
<p>Author:  Christiaan van der Tol (<a class="reference external" href="mailto:c&#46;vandertol&#37;&#52;&#48;utwente&#46;nl" rel="noopener noreferrer" target="_blank">c<span>&#46;</span>vandertol<span>&#64;</span>utwente<span>&#46;</span>nl</a>)
Date:     08 Dec 2016</p>
<blockquote>
<div><p>17 Mar 2020     CvdT    added cluming, mSCOPE representation
25 Jun 2020     PY      Po, Ps, Pso. fix the problem we have with the oblique angles above 80 degrees</p>
</div></blockquote>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.RTMs.RTMt_sb">
<span class="sig-name descname"><span class="pre">RTMt_sb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">constants</span></em>, <em class="sig-param"><span class="pre">rad</span></em>, <em class="sig-param"><span class="pre">soil</span></em>, <em class="sig-param"><span class="pre">leafbio</span></em>, <em class="sig-param"><span class="pre">canopy</span></em>, <em class="sig-param"><span class="pre">gap</span></em>, <em class="sig-param"><span class="pre">Tcu</span></em>, <em class="sig-param"><span class="pre">Tch</span></em>, <em class="sig-param"><span class="pre">Tsu</span></em>, <em class="sig-param"><span class="pre">Tsh</span></em>, <em class="sig-param"><span class="pre">obsdir</span></em>, <em class="sig-param"><span class="pre">spectral</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.RTMs.RTMt_sb" title="Link to this definition"></a></dt>
<dd><p>function ‘RTMt_sb’ calculates total outgoing radiation in hemispherical
direction and total absorbed radiation per leaf and soil component.
Radiation is integrated over the whole thermal spectrum with
Stefan-Boltzman’s equation. This function is a simplified version of
‘RTMt_planck’, and is less time consuming since it does not do the
calculation for each wavelength separately.</p>
<p>Authors: Wout Verhoef and Christiaan van der Tol (<a class="reference external" href="mailto:c&#46;vandertol&#37;&#52;&#48;utwente&#46;nl" rel="noopener noreferrer" target="_blank">c<span>&#46;</span>vandertol<span>&#64;</span>utwente<span>&#46;</span>nl</a>)
date:     5  Nov 2007
update:   13 Nov 2007</p>
<blockquote>
<div><p>16 Nov 2007 CvdT    improved calculation of net radiation
27 Mar 2008 JT      added directional calculation of radiation
24 Apr 2008 JT      Introduced dx as thickness of layer (see parameters)
31 Oct 2008 JT      introduced optional directional calculation
31 Oct 2008 JT      changed initialisation of F1 and F2 -&gt; zeros
07 Nov 2008 CvdT    changed layout
16 Mar 2009 CvdT    removed Tbright calculation</p>
<blockquote>
<div><p>Feb 2013 WV      introduces structures for version 1.40</p>
</div></blockquote>
<p>04 Dec 2019 CvdT    adapted for SCOPE-lite
17 Mar 2020 CvdT    mSCOPE representation</p>
</div></blockquote>
<dl>
<dt>Table of contents of the function</dt><dd><dl class="simple">
<dt>0       preparations</dt><dd><p>0.0     globals
0.1     initialisations
0.2     parameters
0.3     geometric factors of Observer
0.4     geometric factors associated with extinction and scattering
0.5     geometric factors to be used later with rho and tau
0.6     fo for all leaf angle/azumith classes</p>
</dd>
</dl>
<p>1       calculation of upward and downward fluxes
2       total net fluxes
Appendix A. Stefan-Boltzmann</p>
</dd>
</dl>
<p>usage:
[rad] = RTMt_sb(constants,rad,soil,leafbio,canopy,gap,Tcu,Tch,Tsu,Tsh,obsdir,spectral)</p>
<p>Most input and output are structures. These structures are further
specified in a readme file. The temperatures Tcu, Tch, Tsu and Tsh are
variables.</p>
<dl>
<dt>Input:</dt><dd><p>constants   physical constants
rad         a large number of radiative fluxes: spectrally distributed</p>
<blockquote>
<div><p>and integrated, and canopy radiative transfer coefficients</p>
</div></blockquote>
<p>soil        soil properties
leafopt     leaf optical properties
canopy      canopy properties (such as LAI and height)
gap         probabilities of direct light penetration and viewing
Tcu         Temperature of sunlit leaves    (oC), [13x36x60]
Tch         Temperature of shaded leaves    (oC), [13x36x60]
Tsu         Temperature of sunlit soil      (oC), [1]
Tsh         Temperature of shaded soil      (oC), [1]</p>
</dd>
<dt>Output:</dt><dd><dl class="simple">
<dt>rad         a large number of radiative fluxes: spectrally distributed</dt><dd><p>and integrated, and canopy radiative transfer coefficients.
Here, thermal fluxes are added</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="IO.html" class="btn btn-neutral float-left" title="IO (input output)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fluxes.html" class="btn btn-neutral float-right" title="fluxes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, Egor Prikaziuk.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>